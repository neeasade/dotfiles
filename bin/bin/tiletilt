#!/usr/bin/env bash
# view a tiled wallpaper at odd angles

tile=${1:-$(rg --files ${HOME}/tiles | shuf | head -n 1)}
angle=${2:-$((RANDOM % 360))}

printf 'tiletilt "%s" %s\n' "$tile" "$angle"

read w h <<< $(xdpyinfo | grep dimensions:  | awk -F'[ x]+' '{print $3 " " $4}')

convert -size "$((w * 2))x$((w * 2))" "tile:$tile" -rotate "$angle" \
	-gravity center -crop "${w}x${h}-$((w / 2))-$((h / 2))" +repage "/tmp/tiletilt.png"
feh --bg-fill "/tmp/tiletilt.png"
