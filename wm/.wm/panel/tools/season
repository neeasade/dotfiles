#!/usr/bin/env bash
# squeeze lemons into a certain shape/style
# the environment comes from i3blocks generated with ripen

# depend on environment to come from i3blocks
# clickables:

new() {
    # border=${border:-#777777}
    if [ -z "$border" ]; then
	border=$(colort -30 "$bg")
    fi

    # border_side=$(bs O1 B$border U$border +o +u)
    content=$(echo "  $line" | bs B$bg F$fg U$border +u)
    content="$content$(bs B$bg F$fg U$border +u ':  ')"


    # todo: consider gradient fade into section here
    case $align in
	left) printf '%s\n' "$content" ;;
	center) printf '%s\n' "$content" ;;
	right) printf '%s\n' "$content" ;;
    esac
}

spaced_buttons() {
    border=${border:-#777777}
    border_side=$(bs O1 B$border U$bg +o +u)
    content=$(echo "  $line  " | bs B$bg F$fg U$border +u +o)
    content="$border_side$content$border_side"

    case $align in
	left) printf '%s   \n' "$content" ;;
	center) printf '%s   \n' "$content" ;;
	right) printf '    %s\n' "$content" ;;
    esac
}

while IFS=$'\n' read -r line; do
    if [ -z "$line" ]; then
	continue
    fi

    if [ -z "$FORCE" ]; then
	if [ "$lemon" = "tags" ]; then
	    echo "$line"
	    continue
	fi
    fi

    # todo: enhance with buttons from env?

    # echo "$line"
    # spaced_buttons
    new
done
